!function(a){var b='																<div id="reactbox-fade"></div>												<div id="reactbox-lightbox">													<div class="reactbox-close">x</div>											<div class="reactbox-loading"><span>Carregando...</span></div>				<div class="reactbox-arrows">													<div class="arrow arrow-next">&gt;</div>									<div class="arrow arrow-prev">&lt;</div>								</div>																		<div class="contents">															<img src="{{href}}" class="reactbox-image" />							</div>																	</div>																	';a.fn.reactbox=function(c){function d(){loading.hide(),m.show(),f(),m.attr("src",c.href),m.load(function(){if(m.css({position:"fixed",width:"auto",height:"auto"}),c.maxWidth=m.width(),c.maxHeight=m.height(),m.css({position:"static"}),s=!0,j(),!q&&!w)if(1==o.children("img").length){var a=o.children("img:first"),b=[m.width(),m.height(),l.offset().top,l.offset().left];m.css({width:a.width(),height:a.height()}),l.css({top:a.offset().top,left:a.offset().left}),m.animate({width:b[0],height:b[1]},500),l.stop().css({opacity:1}).animate({top:b[2],left:b[3]},500)}else m.hide(),m.fadeIn();w?close.show():close.fadeIn(),q=!0})}function e(){t[c.href]?d():a.get(c.href,function(){t[c.href]=!0,d()}).error(function(){k.click(h),loading.html("Um erro ocorreu ao tentar carregar a imagem"),j()})}function f(){q||(a(window).resize(j),k.click(h),close.click(h),arrows.find(".arrow").click(i))}function g(){a("#reactbox-fade, #reactbox-lightbox").remove(),k=null,l=null,m=null,n=null,o=null,s=!1,p&&p.remove(),p=null,a(window).unbind("resize",j)}function h(){if(w||1!=o.children("img").length)w?(k.css({opacity:0}),l.css({opacity:0}),g()):(k.animate({opacity:0},300),l.animate({opacity:0},300,g));else{var a=o.children("img:first"),b=[a.width(),a.height(),a.offset().top,a.offset().left];close.fadeOut(),arrows.fadeOut(),k.animate({opacity:0},300),m.animate({width:b[0],height:b[1]},500),l.animate({top:b[2],left:b[3]},500,function(){l.animate({opacity:0},300,g)})}}function i(){var b,d=r.index(o);a(this).hasClass("arrow-prev")?(b=r.eq(d-1),0==b.length&&(b=r.eq(-1))):(b=r.eq(d+1),0==b.length&&(b=r.eq(0))),o=b,c.href=o.attr("href"),t[c.href]||loading.show(),e()}function j(){if(u=a(window).width(),v=a(window).height(),w=480>=u)l.css({width:"100%",height:"100%",top:0,left:0}),s&&c.maxWidth&&c.maxHeight&&(m.hide(),n&&n.remove(),l.append('<canvas id="reactbox-canvas" style="width: 100%; height: 100%"></canvas>'),n=l.find("canvas"),p&&p.remove(),p=new ImgTouchCanvas({canvas:document.getElementById("reactbox-canvas"),path:m.attr("src"),desktop:!0}));else{if(n&&(m.show(),n.remove(),n=null),s&&c.maxWidth&&c.maxHeight&&!isNaN(c.maxWidth)&&!isNaN(c.maxHeight)){var b=v>c.maxHeight?c.maxHeight:v,d=u>c.maxWidth?c.maxWidth:u,e=c.maxWidth/c.maxHeight;d/e>b*e?(d=b*e,d>u&&(d=u,b=d/e)):(b=d/e,b>v&&(b=v,d=b*e)),d-=30,b-=30,m.css({width:d,height:b})}l.css({width:"auto",height:"auto"});var f=v/2-(b||l.height())/2,g=u/2-(d||l.width())/2;l.css({top:f,left:g})}}var k,l,m,n,o,p,q,r=a(this),s=!1,t={},u=a(window).width(),v=a(window).height(),w=480>=u,x={type:"image",href:null,maxWidth:null,maxHeight:null};c=jQuery.extend(x,c),this.click(function(d){d.preventDefault(),g(),o=a(this),c.href=o.attr("href"),a("body").append(Mustache.to_html(b,c)),k=a("#reactbox-fade"),l=a("#reactbox-lightbox"),m=a("#reactbox-lightbox .reactbox-image"),loading=a("#reactbox-lightbox .reactbox-loading"),arrows=a("#reactbox-lightbox .reactbox-arrows"),close=a("#reactbox-lightbox .reactbox-close"),q=!1,r.length>1?w?arrows.show():arrows.fadeIn():arrows.hide(),w?(k.css({opacity:.5}).show(),l.css({opacity:1}).show()):(k.css({opacity:0}).show().animate({opacity:.5},300),l.css({opacity:0}).show().animate({opacity:1},300)),m.hide(),j(),e()})}}(jQuery);